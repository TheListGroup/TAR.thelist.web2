-- ราคา/ยูนิต นนทบุรี
-- ราคา/ยูนิต ปทุมธานี
-- ราคา/ยูนิต สมุทรปราการ
-- ราคา/ยูนิต กทม.
-- พื้นที่ขายคอนโด Spotlight ย่านหลัก: ดอนเมือง-ปากเกร็ด-แจ้งวัฒนะ
-- พื้นที่บ้านเดี่ยว Spotlight ย่านหลัก: ดอนเมือง-ปากเกร็ด-แจ้งวัฒนะ
-- พื้นที่บ้านแฝด Spotlight ย่านหลัก: ดอนเมือง-ปากเกร็ด-แจ้งวัฒนะ
-- พื้นที่ทาวน์โฮม Spotlight ย่านหลัก: ดอนเมือง-ปากเกร็ด-แจ้งวัฒนะ
-- พื้นที่โฮมออฟฟิศ Spotlight ย่านหลัก: ดอนเมือง-ปากเกร็ด-แจ้งวัฒนะ
-- พื้นที่ใช้สอยบ้านเดี่ยว Spotlight ย่านหลัก: ดอนเมือง-ปากเกร็ด-แจ้งวัฒนะ
-- พื้นที่ใช้สอยบ้านแฝด Spotlight ย่านหลัก: ดอนเมือง-ปากเกร็ด-แจ้งวัฒนะ
-- พื้นที่ใช้สอยทาวน์โฮม Spotlight ย่านหลัก: ดอนเมือง-ปากเกร็ด-แจ้งวัฒนะ
-- พื้นที่ใช้สอยโฮมออฟฟิศ Spotlight ย่านหลัก: ดอนเมือง-ปากเกร็ด-แจ้งวัฒนะ
-- ราคาเฉลี่ย/ตรม คอนโดสถานีนานา
-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีนานา
-- ขนาดพื้นที่ยูนิตเฉลี่ยคอนโดสถานีนานา
-- unit คอนโดสถานีนานา
-- ราคาเฉลี่ย/ตรม คอนโดสถานีอโศก
-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีอโศก
-- ขนาดพื้นที่ยูนิตเฉลี่ยคอนโดสถานีอโศก
-- unit คอนโดสถานีอโศก
-- ราคาเฉลี่ย/ตรม คอนโดสถานีพร้อมพงษ์
-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีพร้อมพงษ์
-- ขนาดพื้นที่ยูนิตเฉลี่ยคอนโดสถานีพร้อมพงษ์
-- unit คอนโดสถานีพร้อมพงษ์
-- ราคาเฉลี่ย/ตรม คอนโดสถานีทองหล่อ
-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีทองหล่อ
-- ขนาดพื้นที่ยูนิตเฉลี่ยคอนโดสถานีทองหล่อ
-- unit คอนโดสถานีทองหล่อ
-- ราคาเฉลี่ย/ตรม คอนโดสถานีเอกมัย
-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีเอกมัย
-- ขนาดพื้นที่ยูนิตเฉลี่ยคอนโดสถานีเอกมัย
-- unit คอนโดสถานีเอกมัย
-- ราคาเฉลี่ย/ตรม คอนโดสถานีพระโขนง
-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีพระโขนง
-- ขนาดพื้นที่ยูนิตเฉลี่ยคอนโดสถานีพระโขนง
-- unit คอนโดสถานีพระโขนง
-- ราคาเฉลี่ย/ตรม คอนโดสถานีอ่อนนุช
-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีอ่อนนุช
-- ขนาดพื้นที่ยูนิตเฉลี่ยคอนโดสถานีอ่อนนุช
-- unit คอนโดสถานีอ่อนนุช
-- ราคาเฉลี่ย/ตรม คอนโดสถานีบางจาก
-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีบางจาก
-- ขนาดพื้นที่ยูนิตเฉลี่ยคอนโดสถานีบางจาก
-- unit คอนโดสถานีบางจาก
-- ราคาเฉลี่ย/ตรม คอนโดสถานีปุณณวิถี
-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีปุณณวิถี
-- ขนาดพื้นที่ยูนิตเฉลี่ยคอนโดสถานีปุณณวิถี
-- unit คอนโดสถานีปุณณวิถี
-- ราคาเฉลี่ย/ตรม คอนโดสถานีอุดมสุข
-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีอุดมสุข
-- ขนาดพื้นที่ยูนิตเฉลี่ยคอนโดสถานีอุดมสุข
-- unit คอนโดสถานีอุดมสุข
-- ราคาเฉลี่ย/ตรม คอนโดสถานีบางนา
-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีบางนา
-- ขนาดพื้นที่ยูนิตเฉลี่ยคอนโดสถานีบางนา
-- unit คอนโดสถานีบางนา
-- ราคาเฉลี่ย/ตรม คอนโดสถานีแบริ่ง
-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีแบริ่ง
-- ขนาดพื้นที่ยูนิตเฉลี่ยคอนโดสถานีแบริ่ง
-- unit คอนโดสถานีแบริ่ง
-- ราคาเฉลี่ย/ตรม คอนโดสถานีสำโรง
-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีสำโรง
-- ขนาดพื้นที่ยูนิตเฉลี่ยคอนโดสถานีสำโรง
-- unit คอนโดสถานีสำโรง
-- ราคาเฉลี่ย/ตรม คอนโดสถานีปู่เจ้า
-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีปู่เจ้า
-- ขนาดพื้นที่ยูนิตเฉลี่ยคอนโดสถานีปู่เจ้า
-- unit คอนโดสถานีปู่เจ้า
-- ราคาเฉลี่ย/ตรม คอนโดสถานีช้างเอราวัณ
-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีช้างเอราวัณ
-- ขนาดพื้นที่ยูนิตเฉลี่ยคอนโดสถานีช้างเอราวัณ
-- unit คอนโดสถานีช้างเอราวัณ
-- ราคาเฉลี่ย/ตรม คอนโดสถานีรร.นายเรือ
-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีรร.นายเรือ
-- ขนาดพื้นที่ยูนิตเฉลี่ยคอนโดสถานีรร.นายเรือ
-- unit คอนโดสถานีรร.นายเรือ
-- ราคาเฉลี่ย/ตรม คอนโดสถานีปากน้ำ
-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีปากน้ำ
-- ขนาดพื้นที่ยูนิตเฉลี่ยคอนโดสถานีปากน้ำ
-- unit คอนโดสถานีปากน้ำ
-- ราคาเฉลี่ย/ตรม คอนโดสถานีศรีนครินทร์
-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีศรีนครินทร์
-- ขนาดพื้นที่ยูนิตเฉลี่ยคอนโดสถานีศรีนครินทร์
-- unit คอนโดสถานีศรีนครินทร์
-- ราคาเฉลี่ย/ตรม คอนโดสถานีแพรกษา
-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีแพรกษา
-- ขนาดพื้นที่ยูนิตเฉลี่ยคอนโดสถานีแพรกษา
-- unit คอนโดสถานีแพรกษา
-- ราคาเฉลี่ย/ตรม คอนโดสถานีสายลวด
-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีสายลวด
-- ขนาดพื้นที่ยูนิตเฉลี่ยคอนโดสถานีสายลวด
-- unit คอนโดสถานีสายลวด
-- ราคาเฉลี่ย/ตรม คอนโดสถานีเคหะ
-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีเคหะ
-- ขนาดพื้นที่ยูนิตเฉลี่ยคอนโดสถานีเคหะ
-- unit คอนโดสถานีเคหะ

-- ราคา/ยูนิต นนทบุรี
SELECT cpc.Condo_Code
    , cpc.Condo_Price_Per_Unit_Cal
    , DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate)/365 as 'Year'
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
WHERE rc.Province_ID = 12
and DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1825
and cpc.Condo_Price_Per_Unit_Cal is not null;

-- ราคา/ยูนิต ปทุมธานี
SELECT cpc.Condo_Code
    , cpc.Condo_Price_Per_Unit_Cal
    , DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate)/365 as 'Year'
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
WHERE rc.Province_ID = 13
and DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1825
and cpc.Condo_Price_Per_Unit_Cal is not null;

-- ราคา/ยูนิต สมุทรปราการ
SELECT cpc.Condo_Code
    , cpc.Condo_Price_Per_Unit_Cal
    , DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate)/365 as 'Year'
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
WHERE rc.Province_ID = 11
and DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1825
and cpc.Condo_Price_Per_Unit_Cal is not null;

-- ราคา/ยูนิต กทม.
SELECT cpc.Condo_Code
    , cpc.Condo_Price_Per_Unit_Cal
    , DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate)/365 as 'Year'
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
WHERE rc.Province_ID = 10
and DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1825
and cpc.Condo_Price_Per_Unit_Cal is not null;

-- พื้นที่ขายคอนโด Spotlight ย่านหลัก: ดอนเมือง-ปากเกร็ด-แจ้งวัฒนะ
SELECT cpc.Condo_Code
    , rcp.Condo_Salable_Area/rc.Condo_TotalUnit
    , cpc.Condo_Date_Calculate
    , DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate)/365 as 'Year'
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
INNER JOIN real_condo_price AS rcp ON cpc.Condo_Code = rcp.Condo_Code
WHERE rcp.Condo_Salable_Area <> 0 
AND rcp.Condo_Salable_Area IS NOT NULL
AND rc.Condo_TotalUnit <> 0
AND rc.Condo_TotalUnit IS NOT NULL
AND rc.Condo_Latitude <> ''
AND rc.Condo_Longitude <> ''
AND rc.RealDistrict_Code = 'M17'
AND rc.Condo_Status = 1  
ORDER BY `Year` ASC

-- พื้นที่บ้านเดี่ยว Spotlight ย่านหลัก: ดอนเมือง-ปากเกร็ด-แจ้งวัฒนะ
SELECT h.Housing_Code
	, h.Housing_Area_Min
    , h.Housing_Area_Max
    , a.Housing_Build_Date
    , DATEDIFF(CURRENT_DATE,a.Housing_Build_Date)/365 as 'Year'
FROM `housing` h
left join housing_fetch_for_map a on h.Housing_Code = a.Housing_Code
where h.Housing_Status <> '2'
and h.RealDistrict_Code = 'M17'
and h.IS_SD = 1
and (h.Housing_Area_Min is not null or h.Housing_Area_Max is not null)
and a.Housing_Build_Date is not null
and DATEDIFF(CURRENT_DATE,a.Housing_Build_Date) <= 1825;

-- พื้นที่บ้านแฝด Spotlight ย่านหลัก: ดอนเมือง-ปากเกร็ด-แจ้งวัฒนะ
SELECT h.Housing_Code
	, h.Housing_Area_Min
    , h.Housing_Area_Max
    , a.Housing_Build_Date
    , DATEDIFF(CURRENT_DATE,a.Housing_Build_Date)/365 as 'Year'
FROM `housing` h
left join housing_fetch_for_map a on h.Housing_Code = a.Housing_Code
where h.Housing_Status <> '2'
and h.RealDistrict_Code = 'M17'
and h.IS_DD = 1
and (h.Housing_Area_Min is not null or h.Housing_Area_Max is not null)
and a.Housing_Build_Date is not null
and DATEDIFF(CURRENT_DATE,a.Housing_Build_Date) <= 1825;

-- พื้นที่ทาวน์โฮม Spotlight ย่านหลัก: ดอนเมือง-ปากเกร็ด-แจ้งวัฒนะ
SELECT h.Housing_Code
	, h.Housing_Area_Min
    , h.Housing_Area_Max
    , a.Housing_Build_Date
    , DATEDIFF(CURRENT_DATE,a.Housing_Build_Date)/365 as 'Year'
FROM `housing` h
left join housing_fetch_for_map a on h.Housing_Code = a.Housing_Code
where h.Housing_Status <> '2'
and h.RealDistrict_Code = 'M17'
and h.IS_TH = 1
and (h.Housing_Area_Min is not null or h.Housing_Area_Max is not null)
and a.Housing_Build_Date is not null
and DATEDIFF(CURRENT_DATE,a.Housing_Build_Date) <= 1825;

-- พื้นที่โฮมออฟฟิศ Spotlight ย่านหลัก: ดอนเมือง-ปากเกร็ด-แจ้งวัฒนะ
SELECT h.Housing_Code
	, h.Housing_Area_Min
    , h.Housing_Area_Max
    , a.Housing_Build_Date
    , DATEDIFF(CURRENT_DATE,a.Housing_Build_Date)/365 as 'Year'
FROM `housing` h
left join housing_fetch_for_map a on h.Housing_Code = a.Housing_Code
where h.Housing_Status <> '2'
and h.RealDistrict_Code = 'M17'
and h.IS_HO = 1
and (h.Housing_Area_Min is not null or h.Housing_Area_Max is not null)
and a.Housing_Build_Date is not null
and DATEDIFF(CURRENT_DATE,a.Housing_Build_Date) <= 1825;

-- พื้นที่ใช้สอยบ้านเดี่ยว Spotlight ย่านหลัก: ดอนเมือง-ปากเกร็ด-แจ้งวัฒนะ
SELECT h.Housing_Code
	, h.Housing_Usable_Area_Min
    , h.Housing_Usable_Area_Max
    , a.Housing_Build_Date
    , DATEDIFF(CURRENT_DATE,a.Housing_Build_Date)/365 as 'Year'
FROM `housing` h
left join housing_fetch_for_map a on h.Housing_Code = a.Housing_Code
where h.Housing_Status <> '2'
and h.RealDistrict_Code = 'M17'
and h.IS_SD = 1
and (h.Housing_Usable_Area_Min is not null or h.Housing_Usable_Area_Max is not null)
and a.Housing_Build_Date is not null
and DATEDIFF(CURRENT_DATE,a.Housing_Build_Date) <= 1825;

-- พื้นที่ใช้สอยบ้านแฝด Spotlight ย่านหลัก: ดอนเมือง-ปากเกร็ด-แจ้งวัฒนะ
SELECT h.Housing_Code
	, h.Housing_Usable_Area_Min
    , h.Housing_Usable_Area_Max
    , a.Housing_Build_Date
    , DATEDIFF(CURRENT_DATE,a.Housing_Build_Date)/365 as 'Year'
FROM `housing` h
left join housing_fetch_for_map a on h.Housing_Code = a.Housing_Code
where h.Housing_Status <> '2'
and h.RealDistrict_Code = 'M17'
and h.IS_DD = 1
and (h.Housing_Usable_Area_Min is not null or h.Housing_Usable_Area_Max is not null)
and a.Housing_Build_Date is not null
and DATEDIFF(CURRENT_DATE,a.Housing_Build_Date) <= 1825;

-- พื้นที่ใช้สอยทาวน์โฮม Spotlight ย่านหลัก: ดอนเมือง-ปากเกร็ด-แจ้งวัฒนะ
SELECT h.Housing_Code
	, h.Housing_Usable_Area_Min
    , h.Housing_Usable_Area_Max
    , a.Housing_Build_Date
    , DATEDIFF(CURRENT_DATE,a.Housing_Build_Date)/365 as 'Year'
FROM `housing` h
left join housing_fetch_for_map a on h.Housing_Code = a.Housing_Code
where h.Housing_Status <> '2'
and h.RealDistrict_Code = 'M17'
and h.IS_TH = 1
and (h.Housing_Usable_Area_Min is not null or h.Housing_Usable_Area_Max is not null)
and a.Housing_Build_Date is not null
and DATEDIFF(CURRENT_DATE,a.Housing_Build_Date) <= 1825;

-- พื้นที่ใช้สอยโฮมออฟฟิศ Spotlight ย่านหลัก: ดอนเมือง-ปากเกร็ด-แจ้งวัฒนะ
SELECT h.Housing_Code
	, h.Housing_Usable_Area_Min
    , h.Housing_Usable_Area_Max
    , a.Housing_Build_Date
    , DATEDIFF(CURRENT_DATE,a.Housing_Build_Date)/365 as 'Year'
FROM `housing` h
left join housing_fetch_for_map a on h.Housing_Code = a.Housing_Code
where h.Housing_Status <> '2'
and h.RealDistrict_Code = 'M17'
and h.IS_HO = 1
and (h.Housing_Usable_Area_Min is not null or h.Housing_Usable_Area_Max is not null)
and a.Housing_Build_Date is not null
and DATEDIFF(CURRENT_DATE,a.Housing_Build_Date) <= 1825;

-- ราคาเฉลี่ย/ตรม คอนโดสถานีนานา
select round(SUM(Condo_Price_Per_Square_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit),-3)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Square_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E3'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Square_cal is not null) a;

-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีนานา
select round((SUM(Condo_Price_Per_Unit_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit))/1000000,2)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Unit_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E3'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Unit_cal is not null) a;

-- ขนาดพื้นที่ยูนิตเฉลี่ยคอนโดสถานีนานา
select round(SUM(Condo_Salable_Area)/SUM(Condo_TotalUnit))
from (SELECT distinct(cpc.Condo_Code)
        , rc.Condo_TotalUnit
        , rcp.Condo_Salable_Area
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    INNER JOIN real_condo_price AS rcp ON cpc.Condo_Code = rcp.Condo_Code
    WHERE cas.Station_Code = 'E3'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    AND rcp.Condo_Salable_Area <> 0 
    AND rcp.Condo_Salable_Area IS NOT NULL) a;

-- unit คอนโดสถานีนานา
SELECT distinct(cpc.Condo_Code)
	, cpc.Condo_Price_Per_Square
    , rc.Condo_TotalUnit
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
WHERE cas.Station_Code = 'E3'
AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
order by rc.Condo_TotalUnit;

-- ราคาเฉลี่ย/ตรม คอนโดสถานีอโศก
select round(SUM(Condo_Price_Per_Square_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit),-3)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Square_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E4'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Square_cal is not null) a;

-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีอโศก
select round((SUM(Condo_Price_Per_Unit_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit))/1000000,2)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Unit_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E4'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Unit_cal is not null) a;

-- ขนาดพื้นที่ยูนิตเฉลี่ยคอนโดสถานีอโศก
select round(SUM(Condo_Salable_Area)/SUM(Condo_TotalUnit))
from (SELECT distinct(cpc.Condo_Code)
        , rc.Condo_TotalUnit
        , rcp.Condo_Salable_Area
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    INNER JOIN real_condo_price AS rcp ON cpc.Condo_Code = rcp.Condo_Code
    WHERE cas.Station_Code = 'E4'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    AND rcp.Condo_Salable_Area <> 0 
    AND rcp.Condo_Salable_Area IS NOT NULL) a;

-- unit คอนโดสถานีอโศก
SELECT distinct(cpc.Condo_Code)
	, cpc.Condo_Price_Per_Square
    , rc.Condo_TotalUnit
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
WHERE cas.Station_Code = 'E4'
AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
order by rc.Condo_TotalUnit;

-- ราคาเฉลี่ย/ตรม คอนโดสถานีพร้อมพงษ์
select round(SUM(Condo_Price_Per_Square_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit),-3)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Square_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E5'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Square_cal is not null) a;

-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีพร้อมพงษ์
select round((SUM(Condo_Price_Per_Unit_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit))/1000000,2)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Unit_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E5'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Unit_cal is not null) a;

-- ขนาดพื้นที่ยูนิตเฉลี่ย คอนโดสถานีพร้อมพงษ์
select round(SUM(Condo_Salable_Area)/SUM(Condo_TotalUnit))
from (SELECT distinct(cpc.Condo_Code)
        , rc.Condo_TotalUnit
        , rcp.Condo_Salable_Area
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    INNER JOIN real_condo_price AS rcp ON cpc.Condo_Code = rcp.Condo_Code
    WHERE cas.Station_Code = 'E5'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    AND rcp.Condo_Salable_Area <> 0 
    AND rcp.Condo_Salable_Area IS NOT NULL) a;

-- unit คอนโดสถานีพร้อมพงษ์
SELECT distinct(cpc.Condo_Code)
	, cpc.Condo_Price_Per_Square
    , rc.Condo_TotalUnit
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
WHERE cas.Station_Code = 'E5'
AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
order by rc.Condo_TotalUnit;

-- ราคาเฉลี่ย/ตรม คอนโดสถานีทองหล่อ
select round(SUM(Condo_Price_Per_Square_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit),-3)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Square_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E6'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Square_cal is not null) a;

-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีทองหล่อ
select round((SUM(Condo_Price_Per_Unit_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit))/1000000,2)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Unit_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E6'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Unit_cal is not null) a;

-- ขนาดพื้นที่ยูนิตเฉลี่ย คอนโดสถานีทองหล่อ
select round(SUM(Condo_Salable_Area)/SUM(Condo_TotalUnit))
from (SELECT distinct(cpc.Condo_Code)
        , rc.Condo_TotalUnit
        , rcp.Condo_Salable_Area
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    INNER JOIN real_condo_price AS rcp ON cpc.Condo_Code = rcp.Condo_Code
    WHERE cas.Station_Code = 'E6'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    AND rcp.Condo_Salable_Area <> 0 
    AND rcp.Condo_Salable_Area IS NOT NULL) a;

-- unit คอนโดสถานีทองหล่อ
SELECT distinct(cpc.Condo_Code)
	, cpc.Condo_Price_Per_Square
    , rc.Condo_TotalUnit
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
WHERE cas.Station_Code = 'E6'
AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
order by rc.Condo_TotalUnit;

-- ราคาเฉลี่ย/ตรม คอนโดสถานีเอกมัย
select round(SUM(Condo_Price_Per_Square_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit),-3)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Square_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E7'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Square_cal is not null) a;

-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีเอกมัย
select round((SUM(Condo_Price_Per_Unit_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit))/1000000,2)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Unit_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E7'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Unit_cal is not null) a;

-- ขนาดพื้นที่ยูนิตเฉลี่ย คอนโดสถานีเอกมัย
select round(SUM(Condo_Salable_Area)/SUM(Condo_TotalUnit))
from (SELECT distinct(cpc.Condo_Code)
        , rc.Condo_TotalUnit
        , rcp.Condo_Salable_Area
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    INNER JOIN real_condo_price AS rcp ON cpc.Condo_Code = rcp.Condo_Code
    WHERE cas.Station_Code = 'E7'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    AND rcp.Condo_Salable_Area <> 0 
    AND rcp.Condo_Salable_Area IS NOT NULL) a;

-- unit คอนโดสถานีเอกมัย
SELECT distinct(cpc.Condo_Code)
	, cpc.Condo_Price_Per_Square
    , rc.Condo_TotalUnit
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
WHERE cas.Station_Code = 'E7'
AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
order by rc.Condo_TotalUnit;

-- ราคาเฉลี่ย/ตรม คอนโดสถานีพระโขนง
select round(SUM(Condo_Price_Per_Square_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit),-3)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Square_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E8'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Square_cal is not null) a;

-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีพระโขนง
select round((SUM(Condo_Price_Per_Unit_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit))/1000000,2)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Unit_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E8'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Unit_cal is not null) a;

-- ขนาดพื้นที่ยูนิตเฉลี่ย คอนโดสถานีพระโขนง
select round(SUM(Condo_Salable_Area)/SUM(Condo_TotalUnit))
from (SELECT distinct(cpc.Condo_Code)
        , rc.Condo_TotalUnit
        , rcp.Condo_Salable_Area
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    INNER JOIN real_condo_price AS rcp ON cpc.Condo_Code = rcp.Condo_Code
    WHERE cas.Station_Code = 'E8'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    AND rcp.Condo_Salable_Area <> 0 
    AND rcp.Condo_Salable_Area IS NOT NULL) a;

-- unit คอนโดสถานีพระโขนง
SELECT distinct(cpc.Condo_Code)
	, cpc.Condo_Price_Per_Square
    , rc.Condo_TotalUnit
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
WHERE cas.Station_Code = 'E8'
AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
order by rc.Condo_TotalUnit;

-- ราคาเฉลี่ย/ตรม คอนโดสถานีอ่อนนุช
select round(SUM(Condo_Price_Per_Square_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit),-3)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Square_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E9'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Square_cal is not null) a;

-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีอ่อนนุช
select round((SUM(Condo_Price_Per_Unit_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit))/1000000,2)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Unit_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E9'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Unit_cal is not null) a;

-- ขนาดพื้นที่ยูนิตเฉลี่ย คอนโดสถานีอ่อนนุช
select round(SUM(Condo_Salable_Area)/SUM(Condo_TotalUnit))
from (SELECT distinct(cpc.Condo_Code)
        , rc.Condo_TotalUnit
        , rcp.Condo_Salable_Area
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    INNER JOIN real_condo_price AS rcp ON cpc.Condo_Code = rcp.Condo_Code
    WHERE cas.Station_Code = 'E9'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    AND rcp.Condo_Salable_Area <> 0 
    AND rcp.Condo_Salable_Area IS NOT NULL) a;

-- unit คอนโดสถานีอ่อนนุช
SELECT distinct(cpc.Condo_Code)
	, cpc.Condo_Price_Per_Square
    , rc.Condo_TotalUnit
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
WHERE cas.Station_Code = 'E9'
AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
order by rc.Condo_TotalUnit;

-- ราคาเฉลี่ย/ตรม คอนโดสถานีบางจาก
select round(SUM(Condo_Price_Per_Square_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit),-3)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Square_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E10'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Square_cal is not null) a;

-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีบางจาก
select round((SUM(Condo_Price_Per_Unit_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit))/1000000,2)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Unit_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E10'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Unit_cal is not null) a;

-- ขนาดพื้นที่ยูนิตเฉลี่ย คอนโดสถานีบางจาก
select round(SUM(Condo_Salable_Area)/SUM(Condo_TotalUnit))
from (SELECT distinct(cpc.Condo_Code)
        , rc.Condo_TotalUnit
        , rcp.Condo_Salable_Area
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    INNER JOIN real_condo_price AS rcp ON cpc.Condo_Code = rcp.Condo_Code
    WHERE cas.Station_Code = 'E10'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    AND rcp.Condo_Salable_Area <> 0 
    AND rcp.Condo_Salable_Area IS NOT NULL) a;

-- unit คอนโดสถานีบางจาก
SELECT distinct(cpc.Condo_Code)
	, cpc.Condo_Price_Per_Square
    , rc.Condo_TotalUnit
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
WHERE cas.Station_Code = 'E10'
AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
order by rc.Condo_TotalUnit;

-- ราคาเฉลี่ย/ตรม คอนโดสถานีปุณณวิถี
select round(SUM(Condo_Price_Per_Square_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit),-3)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Square_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E11'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Square_cal is not null) a;

-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีปุณณวิถี
select round((SUM(Condo_Price_Per_Unit_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit))/1000000,2)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Unit_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E11'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Unit_cal is not null) a;

-- ขนาดพื้นที่ยูนิตเฉลี่ย คอนโดสถานีปุณณวิถี
select round(SUM(Condo_Salable_Area)/SUM(Condo_TotalUnit))
from (SELECT distinct(cpc.Condo_Code)
        , rc.Condo_TotalUnit
        , rcp.Condo_Salable_Area
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    INNER JOIN real_condo_price AS rcp ON cpc.Condo_Code = rcp.Condo_Code
    WHERE cas.Station_Code = 'E11'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    AND rcp.Condo_Salable_Area <> 0 
    AND rcp.Condo_Salable_Area IS NOT NULL) a;

-- unit คอนโดสถานีปุณณวิถี
SELECT distinct(cpc.Condo_Code)
	, cpc.Condo_Price_Per_Square
    , rc.Condo_TotalUnit
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
WHERE cas.Station_Code = 'E11'
AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
order by rc.Condo_TotalUnit;

-- ราคาเฉลี่ย/ตรม คอนโดสถานีอุดมสุข
select round(SUM(Condo_Price_Per_Square_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit),-3)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Square_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E12'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Square_cal is not null) a;

-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีอุดมสุข
select round((SUM(Condo_Price_Per_Unit_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit))/1000000,2)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Unit_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E12'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Unit_cal is not null) a;

-- ขนาดพื้นที่ยูนิตเฉลี่ย คอนโดสถานีอุดมสุข
select round(SUM(Condo_Salable_Area)/SUM(Condo_TotalUnit))
from (SELECT distinct(cpc.Condo_Code)
        , rc.Condo_TotalUnit
        , rcp.Condo_Salable_Area
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    INNER JOIN real_condo_price AS rcp ON cpc.Condo_Code = rcp.Condo_Code
    WHERE cas.Station_Code = 'E12'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    AND rcp.Condo_Salable_Area <> 0 
    AND rcp.Condo_Salable_Area IS NOT NULL) a;

-- unit คอนโดสถานีอุดมสุข
SELECT distinct(cpc.Condo_Code)
	, cpc.Condo_Price_Per_Square
    , rc.Condo_TotalUnit
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
WHERE cas.Station_Code = 'E12'
AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
order by rc.Condo_TotalUnit;

-- ราคาเฉลี่ย/ตรม คอนโดสถานีบางนา
select round(SUM(Condo_Price_Per_Square_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit),-3)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Square_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E13'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Square_cal is not null) a;

-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีบางนา
select round((SUM(Condo_Price_Per_Unit_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit))/1000000,2)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Unit_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E13'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Unit_cal is not null) a;

-- ขนาดพื้นที่ยูนิตเฉลี่ย คอนโดสถานีบางนา
select round(SUM(Condo_Salable_Area)/SUM(Condo_TotalUnit))
from (SELECT distinct(cpc.Condo_Code)
        , rc.Condo_TotalUnit
        , rcp.Condo_Salable_Area
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    INNER JOIN real_condo_price AS rcp ON cpc.Condo_Code = rcp.Condo_Code
    WHERE cas.Station_Code = 'E13'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    AND rcp.Condo_Salable_Area <> 0 
    AND rcp.Condo_Salable_Area IS NOT NULL) a;

-- unit คอนโดสถานีบางนา
SELECT distinct(cpc.Condo_Code)
	, cpc.Condo_Price_Per_Square
    , rc.Condo_TotalUnit
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
WHERE cas.Station_Code = 'E13'
AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
order by rc.Condo_TotalUnit;

-- ราคาเฉลี่ย/ตรม คอนโดสถานีแบริ่ง
select round(SUM(Condo_Price_Per_Square_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit),-3)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Square_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E14'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Square_cal is not null) a;

-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีแบริ่ง
select round((SUM(Condo_Price_Per_Unit_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit))/1000000,2)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Unit_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E14'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Unit_cal is not null) a;

-- ขนาดพื้นที่ยูนิตเฉลี่ย คอนโดสถานีแบริ่ง
select round(SUM(Condo_Salable_Area)/SUM(Condo_TotalUnit))
from (SELECT distinct(cpc.Condo_Code)
        , rc.Condo_TotalUnit
        , rcp.Condo_Salable_Area
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    INNER JOIN real_condo_price AS rcp ON cpc.Condo_Code = rcp.Condo_Code
    WHERE cas.Station_Code = 'E14'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    AND rcp.Condo_Salable_Area <> 0 
    AND rcp.Condo_Salable_Area IS NOT NULL) a;

-- unit คอนโดสถานีแบริ่ง
SELECT distinct(cpc.Condo_Code)
	, cpc.Condo_Price_Per_Square
    , rc.Condo_TotalUnit
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
WHERE cas.Station_Code = 'E14'
AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
order by rc.Condo_TotalUnit;

-- ราคาเฉลี่ย/ตรม คอนโดสถานีสำโรง
select round(SUM(Condo_Price_Per_Square_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit),-3)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Square_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E15'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Square_cal is not null) a;

-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีสำโรง
select round((SUM(Condo_Price_Per_Unit_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit))/1000000,2)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Unit_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E15'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Unit_cal is not null) a;

-- ขนาดพื้นที่ยูนิตเฉลี่ย คอนโดสถานีสำโรง
select round(SUM(Condo_Salable_Area)/SUM(Condo_TotalUnit))
from (SELECT distinct(cpc.Condo_Code)
        , rc.Condo_TotalUnit
        , rcp.Condo_Salable_Area
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    INNER JOIN real_condo_price AS rcp ON cpc.Condo_Code = rcp.Condo_Code
    WHERE cas.Station_Code = 'E15'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    AND rcp.Condo_Salable_Area <> 0 
    AND rcp.Condo_Salable_Area IS NOT NULL) a;

-- unit คอนโดสถานีสำโรง
SELECT distinct(cpc.Condo_Code)
	, cpc.Condo_Price_Per_Square
    , rc.Condo_TotalUnit
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
WHERE cas.Station_Code = 'E15'
AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
order by rc.Condo_TotalUnit;

-- ราคาเฉลี่ย/ตรม คอนโดสถานีปู่เจ้า
select round(SUM(Condo_Price_Per_Square_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit),-3)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Square_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E16'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Square_cal is not null) a;

-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีปู่เจ้า
select round((SUM(Condo_Price_Per_Unit_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit))/1000000,2)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Unit_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E16'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Unit_cal is not null) a;

-- ขนาดพื้นที่ยูนิตเฉลี่ย คอนโดสถานีปู่เจ้า
select round(SUM(Condo_Salable_Area)/SUM(Condo_TotalUnit))
from (SELECT distinct(cpc.Condo_Code)
        , rc.Condo_TotalUnit
        , rcp.Condo_Salable_Area
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    INNER JOIN real_condo_price AS rcp ON cpc.Condo_Code = rcp.Condo_Code
    WHERE cas.Station_Code = 'E16'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    AND rcp.Condo_Salable_Area <> 0 
    AND rcp.Condo_Salable_Area IS NOT NULL) a;

-- unit คอนโดสถานีปู่เจ้า
SELECT distinct(cpc.Condo_Code)
	, cpc.Condo_Price_Per_Square
    , rc.Condo_TotalUnit
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
WHERE cas.Station_Code = 'E16'
AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
order by rc.Condo_TotalUnit;

-- ราคาเฉลี่ย/ตรม คอนโดสถานีช้างเอราวัณ
select round(SUM(Condo_Price_Per_Square_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit),-3)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Square_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E17'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Square_cal is not null) a;

-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีช้างเอราวัณ
select round((SUM(Condo_Price_Per_Unit_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit))/1000000,2)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Unit_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E17'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Unit_cal is not null) a;

-- ขนาดพื้นที่ยูนิตเฉลี่ย คอนโดสถานีช้างเอราวัณ
select round(SUM(Condo_Salable_Area)/SUM(Condo_TotalUnit))
from (SELECT distinct(cpc.Condo_Code)
        , rc.Condo_TotalUnit
        , rcp.Condo_Salable_Area
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    INNER JOIN real_condo_price AS rcp ON cpc.Condo_Code = rcp.Condo_Code
    WHERE cas.Station_Code = 'E17'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    AND rcp.Condo_Salable_Area <> 0 
    AND rcp.Condo_Salable_Area IS NOT NULL) a;

-- unit คอนโดสถานีช้างเอราวัณ
SELECT distinct(cpc.Condo_Code)
	, cpc.Condo_Price_Per_Square
    , rc.Condo_TotalUnit
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
WHERE cas.Station_Code = 'E17'
AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
order by rc.Condo_TotalUnit;

-- ราคาเฉลี่ย/ตรม คอนโดสถานีรร.นายเรือ
select round(SUM(Condo_Price_Per_Square_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit),-3)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Square_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E18'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Square_cal is not null) a;

-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีรร.นายเรือ
select round((SUM(Condo_Price_Per_Unit_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit))/1000000,2)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Unit_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E18'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Unit_cal is not null) a;

-- ขนาดพื้นที่ยูนิตเฉลี่ย คอนโดสถานีรร.นายเรือ
select round(SUM(Condo_Salable_Area)/SUM(Condo_TotalUnit))
from (SELECT distinct(cpc.Condo_Code)
        , rc.Condo_TotalUnit
        , rcp.Condo_Salable_Area
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    INNER JOIN real_condo_price AS rcp ON cpc.Condo_Code = rcp.Condo_Code
    WHERE cas.Station_Code = 'E18'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    AND rcp.Condo_Salable_Area <> 0 
    AND rcp.Condo_Salable_Area IS NOT NULL) a;

-- unit คอนโดสถานีรร.นายเรือ
SELECT distinct(cpc.Condo_Code)
	, cpc.Condo_Price_Per_Square
    , rc.Condo_TotalUnit
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
WHERE cas.Station_Code = 'E18'
AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
order by rc.Condo_TotalUnit;

-- ราคาเฉลี่ย/ตรม คอนโดสถานีปากน้ำ
select round(SUM(Condo_Price_Per_Square_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit),-3)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Square_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E19'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Square_cal is not null) a;

-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีปากน้ำ
select round((SUM(Condo_Price_Per_Unit_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit))/1000000,2)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Unit_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E19'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Unit_cal is not null) a;

-- ขนาดพื้นที่ยูนิตเฉลี่ย คอนโดสถานีปากน้ำ
select round(SUM(Condo_Salable_Area)/SUM(Condo_TotalUnit))
from (SELECT distinct(cpc.Condo_Code)
        , rc.Condo_TotalUnit
        , rcp.Condo_Salable_Area
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    INNER JOIN real_condo_price AS rcp ON cpc.Condo_Code = rcp.Condo_Code
    WHERE cas.Station_Code = 'E19'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    AND rcp.Condo_Salable_Area <> 0 
    AND rcp.Condo_Salable_Area IS NOT NULL) a;

-- unit คอนโดสถานีปากน้ำ
SELECT distinct(cpc.Condo_Code)
	, cpc.Condo_Price_Per_Square
    , rc.Condo_TotalUnit
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
WHERE cas.Station_Code = 'E19'
AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
order by rc.Condo_TotalUnit;

-- ราคาเฉลี่ย/ตรม คอนโดสถานีศรีนครินทร์
select round(SUM(Condo_Price_Per_Square_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit),-3)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Square_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E20'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Square_cal is not null) a;

-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีศรีนครินทร์
select round((SUM(Condo_Price_Per_Unit_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit))/1000000,2)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Unit_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E20'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Unit_cal is not null) a;

-- ขนาดพื้นที่ยูนิตเฉลี่ย คอนโดสถานีศรีนครินทร์
select round(SUM(Condo_Salable_Area)/SUM(Condo_TotalUnit))
from (SELECT distinct(cpc.Condo_Code)
        , rc.Condo_TotalUnit
        , rcp.Condo_Salable_Area
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    INNER JOIN real_condo_price AS rcp ON cpc.Condo_Code = rcp.Condo_Code
    WHERE cas.Station_Code = 'E20'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    AND rcp.Condo_Salable_Area <> 0 
    AND rcp.Condo_Salable_Area IS NOT NULL) a;

-- unit คอนโดสถานีศรีนครินทร์
SELECT distinct(cpc.Condo_Code)
	, cpc.Condo_Price_Per_Square
    , rc.Condo_TotalUnit
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
WHERE cas.Station_Code = 'E20'
AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
order by rc.Condo_TotalUnit;

-- ราคาเฉลี่ย/ตรม คอนโดสถานีแพรกษา
select round(SUM(Condo_Price_Per_Square_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit),-3)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Square_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E21'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Square_cal is not null) a;

-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีแพรกษา
select round((SUM(Condo_Price_Per_Unit_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit))/1000000,2)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Unit_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E21'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Unit_cal is not null) a;

-- ขนาดพื้นที่ยูนิตเฉลี่ย คอนโดสถานีแพรกษา
select round(SUM(Condo_Salable_Area)/SUM(Condo_TotalUnit))
from (SELECT distinct(cpc.Condo_Code)
        , rc.Condo_TotalUnit
        , rcp.Condo_Salable_Area
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    INNER JOIN real_condo_price AS rcp ON cpc.Condo_Code = rcp.Condo_Code
    WHERE cas.Station_Code = 'E21'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    AND rcp.Condo_Salable_Area <> 0 
    AND rcp.Condo_Salable_Area IS NOT NULL) a;

-- unit คอนโดสถานีแพรกษา
SELECT distinct(cpc.Condo_Code)
	, cpc.Condo_Price_Per_Square
    , rc.Condo_TotalUnit
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
WHERE cas.Station_Code = 'E21'
AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
order by rc.Condo_TotalUnit;

-- ราคาเฉลี่ย/ตรม คอนโดสถานีสายลวด
select round(SUM(Condo_Price_Per_Square_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit),-3)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Square_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E22'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Square_cal is not null) a;

-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีสายลวด
select round((SUM(Condo_Price_Per_Unit_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit))/1000000,2)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Unit_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E22'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Unit_cal is not null) a;

-- ขนาดพื้นที่ยูนิตเฉลี่ย คอนโดสถานีสายลวด
select round(SUM(Condo_Salable_Area)/SUM(Condo_TotalUnit))
from (SELECT distinct(cpc.Condo_Code)
        , rc.Condo_TotalUnit
        , rcp.Condo_Salable_Area
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    INNER JOIN real_condo_price AS rcp ON cpc.Condo_Code = rcp.Condo_Code
    WHERE cas.Station_Code = 'E22'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    AND rcp.Condo_Salable_Area <> 0 
    AND rcp.Condo_Salable_Area IS NOT NULL) a;

-- unit คอนโดสถานีสายลวด
SELECT distinct(cpc.Condo_Code)
	, cpc.Condo_Price_Per_Square
    , rc.Condo_TotalUnit
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
WHERE cas.Station_Code = 'E22'
AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
order by rc.Condo_TotalUnit;

-- ราคาเฉลี่ย/ตรม คอนโดสถานีเคหะ
select round(SUM(Condo_Price_Per_Square_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit),-3)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Square_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E23'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Square_cal is not null) a;

-- ราคาเฉลี่ย/ยูนิต คอนโดสถานีเคหะ
select round((SUM(Condo_Price_Per_Unit_cal*Condo_TotalUnit)/SUM(Condo_TotalUnit))/1000000,2)
from (SELECT distinct(cpc.Condo_Code)
        , cpc.Condo_Price_Per_Unit_cal
        , rc.Condo_TotalUnit
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    WHERE cas.Station_Code = 'E23'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    and cpc.Condo_Price_Per_Unit_cal is not null) a;

-- ขนาดพื้นที่ยูนิตเฉลี่ย คอนโดสถานีเคหะ
select round(SUM(Condo_Salable_Area)/SUM(Condo_TotalUnit))
from (SELECT distinct(cpc.Condo_Code)
        , rc.Condo_TotalUnit
        , rcp.Condo_Salable_Area
    FROM all_condo_price_calculate AS cpc
    INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
    INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
    INNER JOIN real_condo_price AS rcp ON cpc.Condo_Code = rcp.Condo_Code
    WHERE cas.Station_Code = 'E23'
    AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
    AND rcp.Condo_Salable_Area <> 0 
    AND rcp.Condo_Salable_Area IS NOT NULL) a;

-- unit คอนโดสถานีเคหะ
SELECT distinct(cpc.Condo_Code)
	, cpc.Condo_Price_Per_Square
    , rc.Condo_TotalUnit
FROM all_condo_price_calculate AS cpc
INNER JOIN real_condo AS rc ON cpc.Condo_Code = rc.Condo_Code
INNER JOIN condo_around_station AS cas ON cpc.Condo_Code = cas.Condo_Code
WHERE cas.Station_Code = 'E23'
AND DATEDIFF(CURRENT_DATE,cpc.Condo_Date_Calculate) <= 1826
order by rc.Condo_TotalUnit;